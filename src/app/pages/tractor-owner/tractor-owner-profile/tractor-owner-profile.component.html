<div class="container-fluid">
  <app-page-title
    title="Profile"
    [breadcrumbItems]="breadCrumbItems"
  ></app-page-title>

  <div class="row">
    <div class="col-xl-4">
      <div class="card overflow-hidden">
        <div class="bg-soft bg-primary">
          <div class="row">
            <div class="col-8">
              <div class="text-primary p-3">
                <h5 class="text-primary">Tractor Owner Profile</h5>
                <p class="mb-4">View and Edit Profile</p>
              </div>
            </div>

            <!-- <div class="col-4 mr-2">
              <div class="row mt-4">
                <div
                  class="align-self-end"
                  style="
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                  "
                >
                  <button class="btn btn-info btn-sm">Change Password</button>
                </div>
              </div>
            </div> -->
          </div>
        </div>
        <div class="card-body pt-0">
          <div class="row">
            <div class="col-sm-4">
              <div class="avatar-md profile-user-wid mb-4">
                <img
                  src="assets/images/users/default-img.jpg"
                  alt=""
                  class="img-thumbnail rounded-circle"
                />
              </div>
              <h5 class="font-size-15 text-truncate">
                {{ tractorOwner?.firstName }} {{ tractorOwner?.lastName }}
              </h5>
              <!-- <p class="text-muted mb-0 text-truncate">UI/UX Designer</p> -->
            </div>

            <div class="col-sm-8">
              <div class="pt-4">
                <div class="row">
                  <div class="col-6">
                    <p class="text-muted mb-0 text-center">No. of Farms</p>
                    <h5 class="font-size-13 text-center">6,700</h5>
                  </div>
                  <div class="col-6">
                    <p class="text-muted mb-0 text-center">Total Requests</p>
                    <h5 class="font-size-13 text-center">{{ 0 | number }}</h5>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end card -->

      <div class="card">
        <div class="card-body">
          <h4 class="card-title mb-4">Personal Information</h4>
          <div class="table-responsive">
            <table class="table table-nowrap mb-0">
              <tbody>
                <tr>
                  <th scope="row">Role :</th>
                  <td>{{ tractorOwner?.role }}</td>
                </tr>
                <tr>
                  <th scope="row">First Name :</th>
                  <td>{{ tractorOwner?.firstName }}</td>
                </tr>
                <tr>
                  <th scope="row">last Name :</th>
                  <td>{{ tractorOwner?.lastName }}</td>
                </tr>
                <tr>
                  <th scope="row">Other Name :</th>
                  <td>{{ tractorOwner?.otherName }}</td>
                </tr>
                <tr>
                  <th scope="row">Phone Number :</th>
                  <td>{{ tractorOwner?.phone }}</td>
                </tr>
                <tr>
                  <th scope="row">E-mail :</th>
                  <td>{{ tractorOwner?.email }}</td>
                </tr>
                <tr>
                  <th scope="row">Address :</th>
                  <td>{{ tractorOwner?.address }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- end card -->
    </div>

    <div class="col-xl-8">
      <div class="card">
        <div class="card-body">
          <!-- <h4 class="card-title mb-4">Tasks</h4> -->
          <ul
            ngbNav
            #nav1="ngbNav"
            [activeId]="1"
            class="nav-pills bg-light rounded"
          >
            <li [ngbNavItem]="1">
              <a ngbNavLink>Tractor Requests</a>
              <ng-template ngbNavContent>
                <ngx-simplebar style="height: 250px">
                  <dx-data-grid
                    id="gridContainer"
                    [dataSource]="data"
                    keyExpr="id"
                    [showBorders]="true"
                    [showColumnLines]="true"
                    [showRowLines]="true"
                    [rowAlternationEnabled]="true"
                    [columnAutoWidth]="true"
                    [allowColumnResizing]="true"
                  >
                    <dxo-paging [pageSize]="10"> </dxo-paging>
                    <dxo-selection mode="single"></dxo-selection>
                    <div>
                      <dx-button
                        stylingMode="contained"
                        text="Contained"
                        type="normal"
                        [width]="120"
                      >
                      </dx-button>
                    </div>
                    <dxo-export
                      [enabled]="true"
                      [allowExportSelectedData]="true"
                    ></dxo-export>

                    <dxo-search-panel
                      [visible]="true"
                      [width]="350"
                    ></dxo-search-panel>

                    <dxi-column
                      dataField="firstName"
                      caption="First Name"
                    ></dxi-column>

                    <dxi-column
                      dataField="scheduledDate"
                      caption="Scheduled Date"
                    ></dxi-column>

                    <!-- <dxi-column caption="View" name="delistBtn" type="buttons">
                      <dxi-button
                        text="View"
                        [onClick]="viewRecord"
                      ></dxi-button>
                    </dxi-column> -->

                    <dxo-summary>
                      <dxi-total-item column="id" summaryType="count">
                      </dxi-total-item>
                    </dxo-summary>
                  </dx-data-grid>
                </ngx-simplebar>
              </ng-template>
            </li>
            <li [ngbNavItem]="2">
              <a ngbNavLink>Tractors</a>
              <ng-template ngbNavContent>
                <div class="row p-4">
                  <div class="col-6">
                    <h4
                      class="card-title"
                      style="padding: 0px; font-size: 1.5rem"
                    >
                      Manage Tractor
                    </h4>
                    <p style="font-size: 1rem">
                      List all tractors managed by owner.
                    </p>
                  </div>
                  <div class="col-6">
                    <dx-button
                      stylingMode="contained"
                      text="Contained"
                      type="normal"
                      style="float: right; margin-left: 10px"
                      [width]="150"
                      (onClick)="onShowCreateRecordModal()"
                    >
                      <span style="margin-right: 10px"
                        ><i class="bx bx-slider" style="font-size: 20px"></i
                      ></span>
                      <p style="margin: 0px; font-size: 14px; font-weight: 500">
                        Add Tractor
                      </p>
                    </dx-button>
                  </div>
                </div>
                <ngx-simplebar style="height: 250px">
                  <!-- table goes here -->
                  <dx-data-grid
                    id="gridContainer"
                    [dataSource]="tractorOwner?.tractors"
                    keyExpr="id"
                    [showBorders]="true"
                    [showColumnLines]="true"
                    [showRowLines]="true"
                    [rowAlternationEnabled]="true"
                    [columnAutoWidth]="true"
                    [allowColumnResizing]="true"
                  >
                    <dxo-paging [pageSize]="10"> </dxo-paging>
                    <dxo-selection mode="single"></dxo-selection>
                    <div>
                      <dx-button
                        stylingMode="contained"
                        text="Contained"
                        type="normal"
                        [width]="120"
                      >
                      </dx-button>
                    </div>
                    <dxo-export
                      [enabled]="true"
                      [allowExportSelectedData]="true"
                    ></dxo-export>

                    <dxo-search-panel
                      [visible]="true"
                      [width]="350"
                    ></dxo-search-panel>

                    <dxi-column
                      dataField="specialization"
                      caption="specialization"
                    ></dxi-column>
                    <dxi-column dataField="model" caption="Model"></dxi-column>
                    <dxi-column
                      dataField="yearOfManufacture"
                      caption="year"
                    ></dxi-column>
                    <dxi-column
                      dataField="status"
                      caption="Status"
                    ></dxi-column>

                    <!-- <dxi-column caption="View" name="delistBtn" type="buttons">
                      <dxi-button
                        text="View"
                        [onClick]="viewRecord"
                      ></dxi-button>
                    </dxi-column> -->

                    <dxo-summary>
                      <dxi-total-item column="id" summaryType="count">
                      </dxi-total-item>
                    </dxo-summary>
                  </dx-data-grid>
                </ngx-simplebar>
              </ng-template>
            </li>
          </ul>
          <div [ngbNavOutlet]="nav1" class="mt-4"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- end row -->
</div>

<ng-template #updateRecordModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="exampleModalLabel">Create Tractor Owner</h5>
    <button
      type="button"
      class="btn-close"
      (click)="closeModal()"
      aria-label="Close"
    ></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="mb-3">
          <label
            for="ownerType"
            [class.text-danger]="ownerType.invalid &amp;&amp; ownerType.touched"
            class="form-label"
            >Owner Type <span class="text-danger">*</span></label
          >
          <ng-select
            [items]="ownerTypeList"
            bindValue="name"
            bindLabel="name"
            name="ownerType"
            #ownerType="ngModel"
            [(ngModel)]="owner.ownerType"
            [class.is-invalid]="ownerType.invalid &amp;&amp; ownerType.touched"
            placeholder="--Select Owner Type--"
            required
          ></ng-select>

          <div *ngIf="ownerType.invalid &amp;&amp; ownerType.touched">
            <small *ngIf="ownerType.errors?.required" class="text-danger"
              >Owner Type is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="firstName"
            [class.text-danger]="firstName.invalid &amp;&amp; firstName.touched"
            class="form-label"
            >First Name <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="firstName"
            #firstName="ngModel"
            [(ngModel)]="owner.firstName"
            [class.is-invalid]="firstName.invalid &amp;&amp; firstName.touched"
            placeholder="Enter First Name"
            required
          />

          <div *ngIf="firstName.invalid &amp;&amp; firstName.touched">
            <small *ngIf="firstName.errors?.required" class="text-danger"
              >First Name is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="lastName"
            [class.text-danger]="lastName.invalid &amp;&amp; lastName.touched"
            class="form-label"
            >Last Name <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="lastName"
            #lastName="ngModel"
            [(ngModel)]="owner.lastName"
            [class.is-invalid]="lastName.invalid &amp;&amp; lastName.touched"
            placeholder="Enter Last Name"
            required
          />

          <div *ngIf="lastName.invalid &amp;&amp; lastName.touched">
            <small *ngIf="lastName.errors?.required" class="text-danger"
              >Last Name is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="otherName"
            [class.text-danger]="otherName.invalid &amp;&amp; otherName.touched"
            class="form-label"
            >Other Name
            <!-- <span class="text-danger">*</span> -->
          </label>
          <input
            type="text"
            class="form-control"
            name="otherName"
            #otherName="ngModel"
            [(ngModel)]="owner.otherName"
            [class.is-invalid]="otherName.invalid &amp;&amp; otherName.touched"
            placeholder="Enter Other Name"
          />

          <div *ngIf="otherName.invalid &amp;&amp; otherName.touched">
            <small *ngIf="otherName.errors?.required" class="text-danger"
              >Other Name is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="phone"
            [class.text-danger]="phone.invalid &amp;&amp; phone.touched"
            class="form-label"
            >Phone <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="phone"
            #phone="ngModel"
            [(ngModel)]="owner.phone"
            [class.is-invalid]="phone.invalid &amp;&amp; phone.touched"
            placeholder="Enter Phone Number"
            required
          />

          <div *ngIf="phone.invalid &amp;&amp; phone.touched">
            <small *ngIf="phone.errors?.required" class="text-danger"
              >Phone Number is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="email"
            [class.text-danger]="email.invalid &amp;&amp; email.touched"
            class="form-label"
            >Email <span class="text-danger">*</span></label
          >
          <input
            type="email"
            class="form-control"
            name="email"
            #email="ngModel"
            [(ngModel)]="owner.email"
            [class.is-invalid]="email.invalid &amp;&amp; email.touched"
            placeholder="Enter Email"
            required
          />

          <div *ngIf="email.invalid &amp;&amp; email.touched">
            <small *ngIf="email.errors?.required" class="text-danger"
              >Email is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="address"
            [class.text-danger]="address.invalid &amp;&amp; address.touched"
            class="form-label"
            >Address <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="address"
            #address="ngModel"
            [(ngModel)]="owner.address"
            [class.is-invalid]="address.invalid &amp;&amp; address.touched"
            placeholder="Enter Address"
            required
          />

          <div *ngIf="address.invalid &amp;&amp; address.touched">
            <small *ngIf="address.errors?.required" class="text-danger"
              >Address is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="state"
            [class.text-danger]="state.invalid &amp;&amp; state.touched"
            class="form-label"
            >State <span class="text-danger">*</span></label
          >
          <ng-select
            [items]="stateList"
            bindValue="id"
            bindLabel="name"
            name="state"
            #state="ngModel"
            [(ngModel)]="owner.state"
            [class.is-invalid]="state.invalid &amp;&amp; state.touched"
            placeholder="--Select State--"
            required
          ></ng-select>

          <div *ngIf="state.invalid &amp;&amp; state.touched">
            <small *ngIf="state.errors?.required" class="text-danger"
              >State is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="city"
            [class.text-danger]="city.invalid &amp;&amp; city.touched"
            class="form-label"
            >City <span class="text-danger">*</span></label
          >
          <ng-select
            [items]="cityList"
            bindValue="id"
            bindLabel="name"
            name="city"
            #city="ngModel"
            [(ngModel)]="owner.city"
            [class.is-invalid]="city.invalid &amp;&amp; city.touched"
            placeholder="--Select City--"
            required
          ></ng-select>

          <div *ngIf="city.invalid &amp;&amp; city.touched">
            <small *ngIf="city.errors?.required" class="text-danger"
              >City is Required</small
            >
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button
        *ngIf="!isLoading"
        class="btn"
        style="background-color: #2a3042; color: #ffffff"
        (click)="onSubmit()"
      >
        Create Tractor Owner
      </button>
      <button
        *ngIf="isLoading"
        class="btn"
        style="background-color: #2a3042; color: #ffffff"
        disabled
      >
        Processing <span><i class="bx bx-loader bx-spin"></i></span>
      </button>
    </div>
  </div>
</ng-template>

<ng-template #createTractorModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="exampleModalLabel">Register Tractor</h5>
    <button
      type="button"
      class="btn-close"
      (click)="closeModal()"
      aria-label="Close"
    ></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="mb-3">
          <label
            for="specialization"
            [class.text-danger]="specialization.invalid &amp;&amp; specialization.touched"
            class="form-label"
            >Specialization <span class="text-danger">*</span></label
          >
          <ng-select
            [items]="specializationList"
            bindValue="name"
            bindLabel="name"
            name="specialization"
            #specialization="ngModel"
            [(ngModel)]="obj.specialization"
            [class.is-invalid]="specialization.invalid &amp;&amp; specialization.touched"
            placeholder="--Select Owner Type--"
            required
          ></ng-select>

          <div *ngIf="specialization.invalid &amp;&amp; specialization.touched">
            <small *ngIf="specialization.errors?.required" class="text-danger"
              >Specialization is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="model"
            [class.text-danger]="model.invalid &amp;&amp; model.touched"
            class="form-label"
            >Model <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="model"
            #model="ngModel"
            [(ngModel)]="obj.model"
            [class.is-invalid]="model.invalid &amp;&amp; model.touched"
            placeholder="Enter Model"
            required
          />

          <div *ngIf="model.invalid &amp;&amp; model.touched">
            <small *ngIf="model.errors?.required" class="text-danger"
              >Model is Required</small
            >
          </div>
        </div>
      </div>

      <div class="col-lg-6 col-md-6 col-sm-12">
        <div class="mb-3">
          <label
            for="yearOfManufacture"
            [class.text-danger]="yearOfManufacture.invalid &amp;&amp; yearOfManufacture.touched"
            class="form-label"
            >Year Of Manufacture <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            name="yearOfManufacture"
            #yearOfManufacture="ngModel"
            [(ngModel)]="obj.yearOfManufacture"
            [class.is-invalid]="yearOfManufacture.invalid &amp;&amp; yearOfManufacture.touched"
            placeholder="Enter Year Of Manufacture"
            required
          />

          <div
            *ngIf="yearOfManufacture.invalid &amp;&amp; yearOfManufacture.touched"
          >
            <small
              *ngIf="yearOfManufacture.errors?.required"
              class="text-danger"
              >Year Of Manufacture is Required</small
            >
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button
        *ngIf="!isLoading"
        class="btn"
        style="background-color: #2a3042; color: #ffffff"
        (click)="onSubmit()"
      >
        Create Tractor
      </button>
      <button
        *ngIf="isLoading"
        class="btn"
        style="background-color: #2a3042; color: #ffffff"
        disabled
      >
        Processing <span><i class="bx bx-loader bx-spin"></i></span>
      </button>
    </div>
  </div>
</ng-template>
